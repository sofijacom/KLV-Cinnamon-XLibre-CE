# f_00_Void_KLV_cinnamon_no-kernel_XLibre.plug
# version="1.0"; revision="-CE"
# Kennel Linux Void outfitted with a cinnamon desktop and no kernel
# Uses xLibre for graphics
# Creation date 5Nov2025; Revision date: 5Nov2025
# Copyright Kennel Linux team; Licence MIT

# build this via terminal commands:build_firstrib_rootfs.sh
# export CONNECTION_TIMEOUT=-1  **not needed with versions greater than v501**
# ./build_firstrib_rootfs.sh void rolling amd64 f_00_Void_KLV_cinnamon_no-kernel_XLibre.plug
# Architecture i386 will probably successfully build too as an alternative to amd64

# login is user=root passwd=root

# All the parameters/commandlines can be appropriately changed:
# Simply comment in or comment out till you have what you desire
# or add new packages to the xbps-install lists.
# You can add as many valid commandlines as you want in here.
#
# base system
xbps-install -y base-minimal ncurses-base bash
xbps-install -y file mc xterm xauth dbus-glib eudev
xbps-install -y shadow wpa_supplicant  # needed for most wifi
xbps-install -y ntfs-3g zstd zip 7zip unzip p7zip rsync kmod xwininfo


# add Xlibe github mirror repository-x86_64-glibc
cat <<'SETMIRROR' > /etc/xbps.d/99-repository-xlibre.conf
repository=https://github.com/sofijacom/xlibre/releases/latest/download
SETMIRROR

cat <<'EOF' >> /var/db/xbps/keys/00:ca:42:57:c9:c0:9a:ec:94:b4:7d:97:e5:a9:aa:1e.plist
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>public-key</key>
	<data>LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF6aFR1SkVjalBFZzZaUnNGbThtLwpaRnY0RWoyNUZVZzRZR3JQZlI3cWdaaGs5MExWd1hnTnVBQVl2TXFrSmpDd1dueEdYZVNzWUgyNFpSaFhiSHNvCm1DOGJFSDBOWkpmWGRYWFl3Rjg1dGl3b0RGRkpxOE0wN3daT0JsVmI4YXhkRm96UElpWXlRUEMxN1BwTjg0UksKS3NzZkJtQmt0dDUwbGptUWpmQW5lV21tZzF5VTRlSWZvR3AvamgrWW9TUGkyTzZTQi9ZVVJpZnNFYmlUK1RoMQpGdmpZTWhCb1VmQ2NGaGlIb3hDWXJOREhNOURSM21lUVI5ZkFuTEhKNEdXclhoMy84TjFhTngwcnZXckdSNDlJCkJrenNJdjErL2hHNzdyVG54Z3VPNGx0QVZ0QnljdVhRa2ZoWlpzMCtNSXphMzZpaVJja1lVRVVzYVFtQkJnUXMKaHdJREFRQUIKLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCg==</data>
	<key>public-key-size</key>
	<integer>2048</integer>
	<key>signature-by</key>
	<string>xlibre-github-actions</string>
</dict>
</plist>

EOF


xbps-install -Su

echo xlibre xlibre-server xlibre-server-common \
| xargs -n1 xbps-install -y
echo xlibre-server-xephyr xlibre-server-xnest xlibre-server-xvfb \
| xargs -n1 xbps-install -y
echo xlibre-xf86-video-amdgpu xlibre-xf86-video-ati \
| xargs -n1 xbps-install -y
echo xlibre-xf86-input-vmmouse xlibre-xf86-input-wacom xlibre-xf86-input-synaptics \
| xargs -n1 xbps-install -y
echo xlibre-xf86-input-evdev xlibre-xf86-input-libinput \
| xargs -n1 xbps-install -y


# set up passwd system
pwconv
grpconv
printf "root\nroot\n" | passwd >/dev/null 2>&1 # Quietly set default root passwd to "root"

# set root to use /bin/bash
usermod --shell /bin/bash root

# Set locale to en_US.UTF-8
sed -i 's/#en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/' /etc/default/libc-locales
sed -i 's/#C.UTF-8 UTF-8/C.UTF-8 UTF-8/' /etc/default/libc-locales
echo "LANG=en_US.UTF-8" >> /etc/environment
echo "LC_ALL=en_US.UTF-8" >> /etc/environment
xbps-reconfigure -f glibc-locales

# Set Bash as shell
xbps-alternatives --set bash

## --------------------------------------------------------------------------
## Cinnamon Desktop configuration / gnome-tweak-tool

xbps-install -y cinnamon cinnamon-control-center cinnamon-desktop cinnamon-translations
xbps-install -y cinnamon-menus cinnamon-screensaver cinnamon-settings-daemon
xbps-install -y gvfs yad gvfs-smb gvfs-mtp gvfs-cdda

# nemo installation packages

xbps-install -y nemo muffin nemo-audio-tab nemo-compare nemo-emblems
xbps-install -y nemo-fileroller nemo-image-converter
xbps-install -y nemo-preview nemo-python
# xbps-install -y nemo-extensions

# Optional packages
#
xbps-install -y geany gftp rox ffmpeg mtpaint parcellite
xbps-install -y octoxbps fox guvcview putty epdfview gnome-terminal
xbps-install -y e2fsprogs yelp gparted viewnior pfetch
xbps-install -y dosfstools mtools cherrytree galculator
xbps-install -y squashfs-tools wget gxmessage leafpad
xbps-install -y btop gpick gcolor2 gufw xtools mpv

# Browser selection
xbps-install -y firefox

# Fix Firefox Fonts
#
ln -s /usr/share/fontconfig/conf.avail/70-no-bitmaps.conf /etc/fonts/conf.d/
xbps-reconfigure -f fontconfig

# Install Audio
#
xbps-install -y pipewire libjack-pipewire wireplumber wireplumber-elogind
xbps-install -y alsa-pipewire alsa-firmware alsa-plugins-pulseaudio alsa-plugins-jack

# disable pulseaudio autostart
mv /etc/xdg/autostart/pulseaudio.desktop /etc/xdg/autostart/pulseaudio.desktop.bak

# symlink pipewire.desktop launcher in /etc/xdg/autostart/
ln -s /usr/share/applications/pipewire.desktop /etc/xdg/autostart/pipewire.desktop

# symlink pipewire-pulse.desktop launcher in /etc/xdg/autostart/
ln -s /usr/share/applications/pipewire-pulse.desktop /etc/xdg/autostart/pipewire-pulse.desktop

mkdir -p /etc/pipewire/pipewire.conf.d
ln -s /usr/share/examples/wireplumber/10-wireplumber.conf /etc/pipewire/pipewire.conf.d/
mkdir -p /etc/pipewire/pipewire.conf.d
ln -s /usr/share/examples/pipewire/20-pipewire-pulse.conf /etc/pipewire/pipewire.conf.d/

mkdir -p /etc/alsa/conf.d
ln -s /usr/share/alsa/alsa.conf.d/50-pipewire.conf /etc/alsa/conf.d
ln -s /usr/share/alsa/alsa.conf.d/99-pipewire-default.conf /etc/alsa/conf.d

# for root desktop
mkdir -p /root/.config/pipewire/pipewire.conf.d
ln -s /usr/share/examples/wireplumber/10-wireplumber.conf /root/.config/pipewire/pipewire.conf.d/
ln -s /usr/share/examples/pipewire/20-pipewire-pulse.conf /root/.config/pipewire/pipewire.conf.d/

# for spot desktop
mkdir -p /home/spot/.config/pipewire/pipewire.conf.d
ln -s /usr/share/examples/wireplumber/10-wireplumber.conf /home/spot/.config/pipewire/pipewire.conf.d/
ln -s /usr/share/examples/pipewire/20-pipewire-pulse.conf /home/spot/.config/pipewire/pipewire.conf.d/

# Cups print service
echo cups cups-filters cups-pdf samba-cups \
| xargs -n1 xbps-install -y
ln -s /etc/sv/cupsd /etc/runit/runsvdir/default/cupsd

# autostart firewall Gufw
ln -s /etc/sv/ufw /var/service

# Bluetooth
# bluez bluez-alsa blueman
# ln -s /etc/sv/bluetoothd /var/service
echo bluez blueman bluez-obex bluez-deprecated libspa-bluetooth \
| xargs -n1 xbps-install -y
ln -s /etc/sv/bluetoothd /etc/runit/runsvdir/default/bluetoothd
usermod -G bluetooth -a root

# dbus
xbps-install -y dbus
ln -s /etc/sv/dbus /etc/runit/runsvdir/default/dbus

# elogind
xbps-install -y elogind
ln -s /etc/sv/elogind /var/service/

# Install Network Manager
#
xbps-install -y NetworkManager network-manager-applet
ln -s /etc/sv/NetworkManager /etc/runit/runsvdir/default/NetworkManager

# Add ~/Startup directory
#
mkdir -p /root/Startup
cat <<'EOF' >> /usr/local/bin/start-up
#!/bin/bash
sleep 5
user_home=$(eval echo ~${SUDO_USER})
ls $user_home/Startup/* | while read J
do
   "$J" &
done
EOF

chmod +x /usr/local/bin/start-up

# Start poorercputemp
mkdir -p /home/spot/.config/autostart
touch /home/spot/.config/autostart/poorercputemp.desktop
cat <<'EOF' >> /home/spot/.config/autostart/poorercputemp.desktop
[Desktop Entry]
Encoding=UTF-8
Type=Application
NoDisplay=true
Name=poorercputemp
Exec=sudo poorercputemp
EOF

# Install
xbps-install -y lightdm lightdm-gtk-greeter

# enable service
# ln -s /etc/sv/lightdm /var/service
# default
ln -s /etc/sv/lightdm /etc/runit/runsvdir/default/lightdm

# install theme, icons
xbps-install -y arc-icon-theme arc-theme

# Add the required settings to the LightDM configuration
# echo "theme-name=Arc-Dark" | sudo tee -a /etc/lightdm/lightdm-gtk-greeter.conf > /dev/null
# echo "icon-theme-name=Arc" | sudo tee -a /etc/lightdm/lightdm-gtk-greeter.conf > /dev/null
# echo "background=/usr/share/backgrounds/gnome/adwaita-l.jpg" | sudo tee -a /etc/lightdm/lightdm-gtk-greeter.conf > /dev/null

cat <<'EOF' >> /etc/lightdm/lightdm-gtk-greeter.conf
theme-name=Arc-Dark
icon-theme-name=Arc
background=/usr/share/backgrounds/gnome/adwaita-l.jpg
EOF

cat <<'EOF' >> /etc/lightdm/lightdm.conf
greeter-session=lightdm-gtk-greeter
EOF

# /etc/lightdm/gtk-greeter.conf
# 
# [Greeter]
# background=/usr/share/backgrounds/gnome/adwaita-l.jpg
# background-color=#003366
# draw-grid=false
# theme-name=Arc-Dark
# icon-theme-name=Arc
# font-name='Cantarell 11'
# xft-antialias=true
# xft-hintstyle=hintfull
# enable-hidpi=auto

# /etc/lightdm/lightdm.conf
#
# greeter-session=lightdm-gtk-greeter
# echo "greeter-session=lightdm-gtk-greeter" | sudo tee -a /etc/lightdm/lightdm.conf > /dev/null

# .xinitrc to use in cinnamon 
#
cat <<'EOF' >> /root/.xinitrc
#!/bin/sh

userresources="$HOME/.Xresources"
usermodmap="$HOME/.Xmodmap"
sysresources="$xinitdir/.Xresources"
sysmodmap="$xinitdir/.Xmodmap"

# merge in defaults and keymaps

if [ -f "$sysresources" ]; then
    if [ -x /usr/bin/cpp ] ; then
        "$xrdb" -merge "$sysresources"
    else
        "$xrdb" -nocpp -merge "$sysresources"
    fi
fi

if [ -f "$sysmodmap" ]; then
    "$xmodmap" "$sysmodmap"
fi

if [ -f "$userresources" ]; then
    if [ -x /usr/bin/cpp ] ; then
        "$xrdb" -merge "$userresources"
    else
        "$xrdb" -nocpp -merge "$userresources"
    fi
fi

if [ -f "$usermodmap" ]; then
    "$xmodmap" "$usermodmap"
fi

# start some nice programs

if [ -d "$xinitdir"/xinitrc.d ] ; then
	for f in "$xinitdir/xinitrc.d"/?*.sh ; do
		[ -x "$f" ] && . "$f"
	done
	unset f
fi

cinnamon-session

EOF

# ~/.Xresources for larger xterm uxterm fonts
cat <<'XRESOURCES' > ~/.Xresources
Xft*antialias: true
Xft*autohint: true
XTerm*background: black
XTerm*foreground: grey
XTerm*cursorColor: grey
XTerm.vt100.geometry: 95x25+150
XTerm.vt100.scrollBar: true
XTerm.vt100.scrollbar.width: 8
XTerm*faceName: Monospace Regular
XTerm*faceSize: 9

UXft*antialias: true
UXft*autohint: true
UXTerm*background: black
UXTerm*foreground: grey
UXTerm*cursorColor: grey
UXTerm.vt100.geometry: 84x25+150
UXTerm*faceName: Monospace Regular
UXTerm*faceSize: 9
XRESOURCES

# ~/.Xresources for larger xterm uxterm fonts
touch  /home/spot/.Xresources
cat <<'XRESOURCES' > /home/spot/.Xresources
Xft*antialias: true
Xft*autohint: true
XTerm*background: black
XTerm*foreground: grey
XTerm*cursorColor: grey
XTerm.vt100.geometry: 95x25+150
XTerm.vt100.scrollBar: true
XTerm.vt100.scrollbar.width: 8
XTerm*faceName: Monospace Regular
XTerm*faceSize: 9

UXft*antialias: true
UXft*autohint: true
UXTerm*background: black
UXTerm*foreground: grey
UXTerm*cursorColor: grey
UXTerm.vt100.geometry: 84x25+150
UXTerm*faceName: Monospace Regular
UXTerm*faceSize: 9
XRESOURCES

# root
# Change to fancy prompt via .bashrc
sed -i '51,$d' ~/.bashrc
echo "pfetch" >> ~/.bashrc
VAR='PS1="\[\e[0;36m\]┌──\[\e[0m\][ \[\e[0;33m\]\u\[\e[0m\]\[\e[0;32m\]@\[\e[0;36m\]\h\[\e[0m\] ] [ \[\e[0;36m\]\t\[\e[0m\] ]\n\[\e[0;36m\]├── \[\e[0;32m\]\w\[\e[0;36m\]\n\[\e[0;36m\]└>\[\e[0m\]" '
echo "$VAR" >> ~/.bashrc

# spot
# Change to fancy prompt via .bashrc
touch /home/spot/.bashrc
sed -i '51,$d' /home/spot/.bashrc
echo "pfetch" >> /home/spot/.bashrc
VAR='PS1="\[\e[0;36m\]┌──\[\e[0m\][ \[\e[0;33m\]\u\[\e[0m\]\[\e[0;32m\]@\[\e[0;36m\]\h\[\e[0m\] ] [ \[\e[0;36m\]\t\[\e[0m\] ]\n\[\e[0;36m\]├── \[\e[0;32m\]\w\[\e[0;36m\]\n\[\e[0;36m\]└>\[\e[0m\]" '
echo "$VAR" >> /home/spot/.bashrc

# .xinitrc to use in cinnamon 
#
touch /home/spot/.xinitrc
cat <<'EOF' >> /home/spot/.xinitrc
#!/bin/sh

userresources="$HOME/.Xresources"
usermodmap="$HOME/.Xmodmap"
sysresources="$xinitdir/.Xresources"
sysmodmap="$xinitdir/.Xmodmap"

# merge in defaults and keymaps

if [ -f "$sysresources" ]; then
    if [ -x /usr/bin/cpp ] ; then
        "$xrdb" -merge "$sysresources"
    else
        "$xrdb" -nocpp -merge "$sysresources"
    fi
fi

if [ -f "$sysmodmap" ]; then
    "$xmodmap" "$sysmodmap"
fi

if [ -f "$userresources" ]; then
    if [ -x /usr/bin/cpp ] ; then
        "$xrdb" -merge "$userresources"
    else
        "$xrdb" -nocpp -merge "$userresources"
    fi
fi

if [ -f "$usermodmap" ]; then
    "$xmodmap" "$usermodmap"
fi

# start some nice programs

if [ -d "$xinitdir"/xinitrc.d ] ; then
	for f in "$xinitdir/xinitrc.d"/?*.sh ; do
		[ -x "$f" ] && . "$f"
	done
	unset f
fi

cinnamon-session
EOF


## USER CONFIGS: Copy main configs to /etc/skel for all normal users later added
#
xbps-install -y sudo
# Configure system for multi-users
#
cp -af /root/. /etc/skel
mkdir -p /etc/skel/.config /etc/skel/.cache /etc/skel/.local/share

# Give wheel group nopasswd sudo rights and create weedog as wheel group member
# echo '%wheel ALL=(ALL) NOPASSWD: ALL' | (VISUAL="tee -a" visudo) # wheel group added to sudo no password required
# useradd -m -G wheel -s /bin/bash weedog  # weedog in wheel group so has elevated sudo permissions
# printf "weedog\nweedog\n" | passwd weedog >/dev/null 2>&1 # Quietly set default weedog passwd to "weedog"

# Create user spot and put in wheel group (and more) and give wheel group nopasswd sudo rights
echo '%wheel ALL=(ALL) NOPASSWD: ALL' | (VISUAL="tee -a" visudo) # wheel group added to sudo no password required
useradd -m -G audio,video,wheel,storage -s /bin/bash spot
printf "spot\nspot" | passwd spot >/dev/null 2>&1 # Quietly set default spot passwd to "spot"


# Create /root directories
#
mkdir -p /root/Desktop
mkdir -p /root/Documents
mkdir -p /root/Downloads
mkdir -p /root/Music
mkdir -p /root/my-applications
mkdir -p /root/Pictures
mkdir -p /root/Public
mkdir -p /root/Startup
mkdir -p /root/Templates
mkdir -p /root/Videos

# Create /home/spot directories
#
mkdir -p /home/spot/Desktop
mkdir -p /home/spot/Documents
mkdir -p /home/spot/Downloads
mkdir -p /home/spot/Music
mkdir -p /home/spot/my-applications
mkdir -p /home/spot/Pictures
mkdir -p /home/spot/Public
mkdir -p /home/spot/Startup
mkdir -p /home/spot/Templates
mkdir -p /home/spot/Videos


# Set permissions
#
chown -R spot:spot /home/spot
chown -R weedog:weedog /home/weedog

# add users to groups and change permissions
#
usermod -a -G audio spot
usermod -a -G video spot
xhost +
chmod 755 /
chmod 755 /bin
chmod 755 /lib

# Copy .desktop files to /root/.local/share/applications and add run-as-spot to the Exec command
#
mkdir -p /root/.local/share/applications
cp /usr/share/applications/octoxbps.desktop  /root/.local/share/applications/octoxbps.desktop
cp /usr/share/applications/octoxbps-notifier.desktop  /root/.local/share/applications/octoxbps-notifier.desktop

cd /root/.local/share/applications/
sed -i 's/^Exec=/&run-as-spot /' octoxbps.desktop
sed -i 's/^Exec=/&run-as-spot /' octoxbps-notifier.desktop
cp /root/.local/share/applications/octoxbps-notifier.desktop /etc/xdg/autostart/octoxbps-notifier.desktop

# Start polkit-gnome-authentication-agent
cp /usr/share/applications/polkit-gnome-authentication-agent-1.desktop /etc/xdg/autostart/polkit-gnome-authentication-agent-1.desktop

# add sudo -spot to .desktop files run-as-spot
# cd /usr/share/applications
# sed -i 's/^Exec=/&sudo -uspot /' octoxbps.desktop
# sed -i 's/^Exec=/&sudo -uspot /' octoxbps-notifier.desktop

# Create nemo desktop launcher
# cat <<'EOF' >> /root/Startup/start_nemo_desktop
#!/bin/sh
# sudo -u spot nemo-desktop
# EOF

# make /root/Startup/start_nemo_desktop executable
# chmod +x /root/Startup/start_nemo_desktop

# Startup
#
mkdir -p /home/spot/.config/autostart
touch /home/spot/.config/autostart/start-up.desktop
cat <<'EOF' >> /home/spot/.config/autostart/start-up.desktop
[Desktop Entry]
Type=Application
Exec=/usr/local/bin/start-up
X-GNOME-Autostart-enabled=true
NoDisplay=false
Hidden=false
Name[en_US]=start-up
Comment[en_US]=start-scripts
X-GNOME-Autostart-Delay=0

EOF
mkdir -p /root/.config/autostart
touch /root/.config/autostart/start-up.desktop
cat <<'EOF' >> /root/.config/autostart/start-up.desktop
[Desktop Entry]
Type=Application
Exec=/usr/local/bin/start-up
X-GNOME-Autostart-enabled=true
NoDisplay=false
Hidden=false
Name[en_US]=start-up
Comment[en_US]=start-scripts
X-GNOME-Autostart-Delay=0

EOF


#### Get KLV custom packages ####
#
# Create and switch to build directory
mkdir -p /root/Build
cd /root/Build

wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/backgrounds-cinnamon-2.0_1.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/desktop-config-1.0_1.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/libfontconfig1-1.12_0.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/gparted-shell-1.0_0.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/mime-add-1.1_0.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/xbps-tools-1.0_3.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/uextract-4.14_0.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/tzupdate2-2.0_2.noarch.xbps
# wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/xluncher-2.1_0.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/default-scripts-1.0_1.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/dropbear-2025.87_1.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/SFS-Load-2.0_1.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/tas-2.0_1.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/packit-pfind-2.0_1.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/gettext-1.0_1.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/run-as-users-1.5_1.noarch.xbps
# wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/inst-xbps-1.8_1.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/gtkhash-1.1.1_1.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/partview-1.0_1.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/pure-ftpd-1.0.51_1.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/syndownload-2.0_1.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/sClock-1.5_1.x86_64.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/swapper-1.2_1.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/save2flash-1.9_0.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/packit-1.25_1.noarch.xbps
wget ‐‐continue https://github.com/techrockedge/xbps_packages/raw/refs/heads/main/psync-2.9_2.x86_64.xbps
wget -c https://github.com/sofijacom/xbps_packages/raw/refs/heads/main/poorercputemp-0.2_1.x86_64.xbps
wget -c https://github.com/sofijacom/xbps_packages/raw/refs/heads/main/dcontrol-2.0_1.x86_64.xbps
wget -c https://github.com/sofijacom/xbps_packages/raw/refs/heads/main/set-cinnamon-theme-root-spot-1.1_1.noarch.xbps
wget -c https://github.com/sofijacom/xbps_packages/raw/refs/heads/main/Cinnamon-xbps-tools-1.2_1.noarch.xbps
wget -c https://github.com/sofijacom/xbps_packages/raw/refs/heads/main/catppuccin-cursors-1.1.2_1.noarch.xbps
wget -c https://github.com/sofijacom/xbps_packages/raw/refs/heads/main/pup-volume-monitor-1.15_0.x86_64.xbps
wget -c https://github.com/sofijacom/xbps_packages/raw/refs/heads/main/Octoxbps-cleaner-cache-1.1.2_1.noarch.xbps


#### Install KLV custom packages ####

# Register and index packages
cd /root
xbps-rindex -a Build/*.xbps

# Install libfontconfig cache fix
xbps-install -y --repository=Build/ libfontconfig1-1.12_0

# Install gparted-shell
xbps-install -y --repository=Build/ gparted-shell-1.0_0

# Install MIME definitions
xbps-install -y --repository=Build/ mime-add-1.1_0

# Install xbps-tools
xbps-install -y --repository=Build/ xbps-tools-1.0_3

# Install uextract
xbps-install -y --repository=Build/ uextract-4.14_0

# Install tzupdate
xbps-install -y --repository=Build/ tzupdate2-2.0_2

# Install xLunch
# xbps-install -y --repository=Build/ xluncher-2.1_0
# xbps-pkgdb -m hold  xlunch-4.1_3

# Install default launch scripts
xbps-install -y --repository=Build/ default-scripts-1.0_1

# Install dropbear
xbps-install -y --repository=Build/ dropbear-2025.87_1

# Install tas
xbps-install -y --repository=Build/ tas-2.0_1

# Install gettext
xbps-install -y --repository=Build/ gettext-1.0_1

# Install swapper
xbps-install -y --repository=Build/ swapper-1.2_1

# Install  backgrounds
xbps-install -y --repository=Build/ backgrounds-cinnamon-2.0_1

# Install run-as-spot and run-as-weedog
xbps-install -y --repository=Build/ run-as-users-1.5_1

# Install inst-xbps
# xbps-install -y --repository=Build/ inst-xbps-1.8_1

# Install gtkhash
xbps-install -y --repository=Build/ gtkhash-1.1.1_1

# Install pure-ftpd
xbps-install -y --repository=Build/ pure-ftpd-1.0.51_1

# Install Syndownload
xbps-install -y --repository=Build/ syndownload-2.0_1

# Install desktop configuration
xbps-install -y --repository=Build/ desktop-config-1.0_1

# Install sClock
xbps-install -y --repository=Build/ sClock-1.5_1

# Install Partview
xbps-install -y --repository=Build/ partview-1.0_1

# Install save2flash RAM2 mechanism
xbps-install -y --repository=Build/ save2flash-1.9_0

# Install psync
xbps-install -y --repository=Build/ psync-2.9_2

# Install  packit-1.25
xbps-install -y --repository=Build/ packit-1.25_1

# Install poorercputemp
xbps-install -y --repository=Build/ poorercputemp-0.2_1

# Install dcontrol
xbps-install -y --repository=Build/ dcontrol-2.0_1

# Install set-cinnamon-theme-root-spot
xbps-install -y --repository=Build/ set-cinnamon-theme-root-spot-1.1_1

# Install Cinnamon-xbps-tools
xbps-install -y --repository=Build/ Cinnamon-xbps-tools-1.2_1

# Install
xbps-install -y --repository=Build/ catppuccin-cursors-1.1.2_1

# Install Volume-monitor
xbps-install -y --repository=Build/ pup-volume-monitor-1.15_0

# Octoxbps-cleaner-cache
xbps-install -y --repository=Build/ Octoxbps-cleaner-cache-1.1.2_1


# Set execution permissions recursivly for binaries and scripts
chmod +x -R /usr/local/bin

echo "stage 2 is complete!!"

# Set lxterminal as default console
# gsettings set org.cinnamon.desktop.default-applications.terminal exec 'lxterminal'

## stage 3 configurations
echo "stage 3 is complete!!"

# Clean Up
#

rm -r /root/Build
rm /var/cache/xbps/*

# Set your timezone. Example:
current_timezone="Etc/UTC"
ln -sf /usr/share/zoneinfo/${current_timezone} /etc/localtime

